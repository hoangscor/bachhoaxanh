<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°ch H√≥a Pastel - Noel Theme</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Snow Canvas -->
    <canvas id="snowCanvas"></canvas>

    <!-- HEADER -->
    <header class="main-header">
        <div class="container header-content">
            <a href="#" class="logo" onclick="app.resetHome(); return false;">
                <div class="logo-text">
                    <span class="logo-line1">B√ÅCH H√ìA <i class="fa-solid fa-cookie-bite"
                            style="font-size:0.8em; animation: sway 3s infinite"></i></span>
                    <span class="logo-line2">PASTEL</span>
                </div>
            </a>

            <div class="search-bar" style="position:relative">
                <input type="text" id="searchInput" placeholder="B·∫°n t√¨m g√¨ h√¥m nay? (th·ªãt, bia, g·∫°o...)"
                    oninput="app.handleSearchInput(this.value)">
                <button id="searchBtn"><i class="fa-solid fa-magnifying-glass"></i></button>
                <div id="searchResults" class="search-dropdown" style="display:none"></div>
            </div>

            <div class="header-actions">
                <!-- Select Location -->
                <div>
                    <i class="fa-solid fa-location-dot" style="color:var(--danger)"></i>
                    <select
                        style="border:none;background:transparent;font-family:inherit;font-weight:600;cursor:pointer">
                        <option>TP.HCM</option>
                        <option>H√† N·ªôi</option>
                        <option>ƒê√† N·∫µng</option>
                    </select>
                </div>

                <!-- Noel Toggle -->
                <button class="noel-toggle" onclick="app.toggleNoelMode()">
                    <span>‚òÉÔ∏è Noel Mode</span>
                </button>

                <div class="auth-box" id="authBox">
                    <!-- JS Injected -->
                </div>

                <div class="header-btns">
                    <button class="icon-btn" onclick="app.openOrderHistory()" title="ƒê∆°n h√†ng">
                        <i class="fa-solid fa-file-invoice"></i>
                    </button>
                    <button class="icon-btn cart-btn" onclick="app.toggleCart()">
                        <i class="fa-solid fa-cart-shopping" style="animation: bounce 3s infinite"></i>
                        <span id="cartBadge" class="badge">0</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="mini-menu-bar">
            <div class="container" style="display:flex; gap:20px; padding:10px 16px; overflow-x:auto;">
                <div style="display:flex; gap:5px; align-items:center"><i class="fa-solid fa-bolt"
                        style="color:orange"></i> Flash sale</div>
                <div style="display:flex; gap:5px; align-items:center"><i class="fa-solid fa-gift"
                        style="color:red"></i> Qu√† Noel</div>
                <div style="display:flex; gap:5px; align-items:center"><i class="fa-solid fa-carrot"
                        style="color:green"></i> T∆∞∆°i s·ªëng</div>
                <div id="adminLink" style="display:none"><a href="admin.html"><i class="fa-solid fa-user-shield"></i>
                        <b>Admin</b></a></div>
            </div>
        </div>
    </header>

    <!-- LAYOUT -->
    <div class="container main-layout">
        <aside class="sidebar" id="sidebarContainer">
            <div class="sidebar-header" style="font-weight:bold; margin-bottom:10px">Danh m·ª•c</div>
            <div id="categoryList">Waiting for API...</div>
        </aside>

        <main class="main-content">
            <!-- Banner with floating icons -->
            <section class="hero-banner" id="heroBanner">
                <!-- Injected by JS -->
            </section>

            <!-- Brands -->
            <section style="margin-bottom:30px">
                <h2>Gian h√†ng & ∆Øu ƒë√£i</h2>
                <div id="brandGrid" style="display:flex; gap:16px; overflow-x:auto; padding-bottom:10px"></div>
            </section>

            <!-- Products -->
            <section id="homeView">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
                    <h2 id="productSectionTitle">S·∫£n ph·∫©m n·ªïi b·∫≠t</h2>
                    <button class="btn-text" style="color:var(--primary-dark); font-weight:600"
                        onclick="app.resetHome()">Xem t·∫•t c·∫£</button>
                </div>
                <div id="productGrid" class="product-grid"></div>
            </section>

            <!-- Product Detail View (Hidden by default) -->
            <section id="productDetailView" style="display:none">
                <div class="breadcrumb" style="margin-bottom:15px; color:#666; font-size:0.9rem">
                    <span onclick="app.resetHome()" style="cursor:pointer">Trang ch·ªß</span> > <span
                        id="pdCategory">...</span> > <span id="pdName">...</span>
                </div>
                <div
                    style="display:flex; gap:30px; background:white; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05)">
                    <div style="flex:1; text-align:center">
                        <img id="pdImage" src="" style="max-width:100%; height:auto; border-radius:8px">
                    </div>
                    <div style="flex:1.5">
                        <h1 id="pdTitle" style="font-size:1.5rem; margin-bottom:10px; color:var(--text)">...</h1>
                        <div style="font-size:0.9rem; color:#888; margin-bottom:15px">M√£ SP: <span id="pdSku">...</span>
                            | T√¨nh tr·∫°ng: <span style="color:green">C√≤n h√†ng</span></div>

                        <div style="display:flex; align-items:baseline; gap:10px; margin-bottom:20px">
                            <span id="pdPrice" style="font-size:1.8rem; color:#d0021b; font-weight:bold">0ƒë</span>
                            <span id="pdOldPrice" style="text-decoration:line-through; color:#999">0ƒë</span>
                            <span id="pdBadge"
                                style="background:var(--danger); color:white; padding:2px 6px; border-radius:4px; font-size:0.8rem; display:none">Gi·∫£m
                                s·ªëc</span>
                        </div>

                        <div
                            style="margin-bottom:20px; padding:15px; background:#f9f9f9; border-radius:8px; font-size:0.9rem">
                            <p>üéÅ <strong>∆Øu ƒë√£i:</strong> Mua online gi·∫£m th√™m 5% (t·ªëi ƒëa 50k).</p>
                            <p>üöõ <strong>Giao h√†ng:</strong> Freeship 3km cho ƒë∆°n t·ª´ 150k.</p>
                        </div>

                        <div style="display:flex; gap:10px">
                            <button class="btn btn-outline" onclick="app.addToCartFromDetail(false)">Th√™m v√†o
                                gi·ªè</button>
                            <button class="btn btn-primary" onclick="app.addToCartFromDetail(true)">Mua ngay</button>
                        </div>
                    </div>
                </div>

                <div style="margin-top:30px">
                    <h3>S·∫£n ph·∫©m li√™n quan</h3>
                    <div id="relatedProductGrid" class="product-grid"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- QuickView -->
    <div id="quickViewModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.closeModal('quickViewModal')">&times;</span>
            <div id="quickViewBody"></div>
        </div>
    </div>

    <!-- Auth -->
    <div id="authModal" class="modal">
        <div class="modal-content" style="text-align:center">
            <span class="close-btn" onclick="app.closeModal('authModal')">&times;</span>
            <h2 style="color:var(--primary-dark)">Th√†nh vi√™n B√°ch H√≥a Pastel</h2>
            <div style="display:flex; gap:10px; margin-bottom:20px; justify-content:center">
                <button class="btn btn-outline"
                    onclick="document.getElementById('loginForm').style.display='block'; document.getElementById('regForm').style.display='none'">ƒêƒÉng
                    Nh·∫≠p</button>
                <button class="btn btn-outline"
                    onclick="document.getElementById('loginForm').style.display='none'; document.getElementById('regForm').style.display='block'">ƒêƒÉng
                    K√Ω</button>
            </div>

            <form id="loginForm" onsubmit="app.handleLogin(event)">
                <div class="form-group"><input name="email" type="email" placeholder="Email (admin@bachhoa.com)"
                        required></div>
                <div class="form-group"><input name="password" type="password" placeholder="M·∫≠t kh·∫©u (admin123)"
                        required></div>
                <button class="btn btn-primary btn-block">ƒêƒÉng Nh·∫≠p</button>
            </form>

            <form id="regForm" style="display:none" onsubmit="app.handleRegister(event)">
                <div class="form-group"><input name="name" placeholder="H·ªç t√™n" required></div>
                <div class="form-group"><input name="email" type="email" placeholder="Email" required></div>
                <div class="form-group"><input name="phone" placeholder="SƒêT" required></div>
                <div class="form-group"><input name="password" type="password" placeholder="M·∫≠t kh·∫©u" required></div>
                <button class="btn btn-primary btn-block">ƒêƒÉng K√Ω</button>
            </form>
        </div>
    </div>

    <!-- Checkout -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.closeModal('checkoutModal')">&times;</span>
            <h2>Thanh To√°n</h2>
            <form onsubmit="return false">
                <div class="form-group"><label>H·ªç t√™n</label><input id="cxName" required></div>
                <div class="form-group"><label>SƒêT</label><input id="cxPhone" required></div>
                <div class="form-group"><label>ƒê·ªãa ch·ªâ</label><input id="cxAddress" required></div>
                <div class="form-group">
                    <label>C√°ch thanh to√°n</label>
                    <select id="cxMethod">
                        <option value="COD">Thanh to√°n khi nh·∫≠n h√†ng</option>
                        <option value="EWALLET">V√≠ ƒëi·ªán t·ª≠</option>
                    </select>
                </div>
                <div style="text-align:right">
                    <button class="btn btn-primary" onclick="app.processCheckout()">X√°c Nh·∫≠n ƒê·∫∑t H√†ng</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Orders -->
    <div id="ordersModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.closeModal('ordersModal')">&times;</span>
            <h2>ƒê∆°n h√†ng c·ªßa t√¥i</h2>
            <div id="ordersList" style="max-height:400px; overflow-y:auto"></div>
        </div>
    </div>

    <!-- Store Modal -->
    <div id="storeModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="app.closeModal('storeModal')">&times;</span>
            <h2>H·ªá th·ªëng c·ª≠a h√†ng B√°ch H√≥a Pastel</h2>
            <div style="margin-bottom:15px">
                <input placeholder="T√¨m c·ª≠a h√†ng g·∫ßn b·∫°n..."
                    style="width:100%; padding:10px; border:1px solid #ddd; border-radius:6px">
            </div>
            <div id="storeList" style="max-height:300px; overflow-y:auto"></div>
        </div>
    </div>

    <!-- Cart Drawer -->
    <div id="cartDrawer" class="cart-drawer">
        <div style="padding:20px; border-bottom:1px solid #eee; display:flex; justify-content:space-between">
            <h3>Gi·ªè h√†ng</h3>
            <span style="font-size:1.5rem; cursor:pointer" onclick="app.toggleCart()">&times;</span>
        </div>
        <div id="cartItems" class="cart-items"></div>
        <div class="cart-footer">
            <div style="display:flex; gap:10px; margin-bottom:10px">
                <input id="couponInput" placeholder="M√£ gi·∫£m gi√° (LUONGVE10)"
                    style="flex:1; padding:8px; border:1px solid #ddd; border-radius:6px">
                <button class="btn btn-outline btn-sm" onclick="app.applyCoupon()">√Åp d·ª•ng</button>
            </div>
            <div style="display:flex; justify-content:space-between; margin-bottom:5px"><span>T·∫°m t√≠nh:</span><span
                    id="cartSubtotal">0ƒë</span></div>
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; color:red"><span>Gi·∫£m
                    gi√°:</span><span id="cartDiscount">-0ƒë</span></div>
            <div style="display:flex; justify-content:space-between; margin-bottom:5px"><span>Ship:</span><span
                    id="cartShipping">...</span></div>
            <div
                style="display:flex; justify-content:space-between; font-weight:bold; font-size:1.2rem; margin-top:10px; border-top:1px dashed #ccc; padding-top:10px">
                <span>T·ªïng:</span><span id="cartTotal">0ƒë</span>
            </div>
            <div id="freeshipBadge"
                style="background:#e0fcf4; color:#4caf93; padding:5px; text-align:center; border-radius:4px; margin:10px 0; font-size:0.9rem; display:none">
                ‚úÖ Freeship 3km</div>
            <button class="btn btn-primary btn-block" onclick="app.openCheckout()">Thanh To√°n</button>
        </div>
    </div>
    <div id="overlay"
        style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:900; display:none"
        onclick="app.toggleCart()"></div>

    <!-- Toast & Live Run -->
    <div id="toast" class="toast"></div>
    <div class="live-run-btn" onclick="app.init()">üöÄ Live Run</div>

    <script src="app.js"></script>
</body>

</html>